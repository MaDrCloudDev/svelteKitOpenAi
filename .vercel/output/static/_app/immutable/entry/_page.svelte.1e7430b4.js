import{S as X,i as Y,s as Z,k as b,q as O,a as L,l as S,m as x,r as I,h as v,c as w,n as p,b as R,G as d,J as B,K as F,L as j,H as q,M as K,u as U}from"../chunks/index.fe9ef46a.js";var J={};(function(f){var r=function(n,s){if(!(this instanceof r))return new r(n,s);this.INITIALIZING=-1,this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,this.url=n,s=s||{},this.headers=s.headers||{},this.payload=s.payload!==void 0?s.payload:"",this.method=s.method||this.payload&&"POST"||"GET",this.withCredentials=!!s.withCredentials,this.FIELD_SEPARATOR=":",this.listeners={},this.xhr=null,this.readyState=this.INITIALIZING,this.progress=0,this.chunk="",this.addEventListener=function(t,e){this.listeners[t]===void 0&&(this.listeners[t]=[]),this.listeners[t].indexOf(e)===-1&&this.listeners[t].push(e)},this.removeEventListener=function(t,e){if(this.listeners[t]!==void 0){var i=[];this.listeners[t].forEach(function(l){l!==e&&i.push(l)}),i.length===0?delete this.listeners[t]:this.listeners[t]=i}},this.dispatchEvent=function(t){if(!t)return!0;t.source=this;var e="on"+t.type;return this.hasOwnProperty(e)&&(this[e].call(this,t),t.defaultPrevented)?!1:this.listeners[t.type]?this.listeners[t.type].every(function(i){return i(t),!t.defaultPrevented}):!0},this._setReadyState=function(t){var e=new CustomEvent("readystatechange");e.readyState=t,this.readyState=t,this.dispatchEvent(e)},this._onStreamFailure=function(t){var e=new CustomEvent("error");e.data=t.currentTarget.response,this.dispatchEvent(e),this.close()},this._onStreamAbort=function(t){this.dispatchEvent(new CustomEvent("abort")),this.close()},this._onStreamProgress=function(t){if(this.xhr){if(this.xhr.status!==200){this._onStreamFailure(t);return}this.readyState==this.CONNECTING&&(this.dispatchEvent(new CustomEvent("open")),this._setReadyState(this.OPEN));var e=this.xhr.responseText.substring(this.progress);this.progress+=e.length,e.split(/(\r\n|\r|\n){2}/g).forEach(function(i){i.trim().length===0?(this.dispatchEvent(this._parseEventChunk(this.chunk.trim())),this.chunk=""):this.chunk+=i}.bind(this))}},this._onStreamLoaded=function(t){this._onStreamProgress(t),this.dispatchEvent(this._parseEventChunk(this.chunk)),this.chunk=""},this._parseEventChunk=function(t){if(!t||t.length===0)return null;var e={id:null,retry:null,data:"",event:"message"};t.split(/\n|\r\n|\r/).forEach(function(l){l=l.trimRight();var o=l.indexOf(this.FIELD_SEPARATOR);if(!(o<=0)){var c=l.substring(0,o);if(c in e){var u=l.substring(o+1).trimLeft();c==="data"?e[c]+=u:e[c]=u}}}.bind(this));var i=new CustomEvent(e.event);return i.data=e.data,i.id=e.id,i},this._checkStreamClosed=function(){this.xhr&&this.xhr.readyState===XMLHttpRequest.DONE&&this._setReadyState(this.CLOSED)},this.stream=function(){this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._checkStreamClosed.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamAbort.bind(this)),this.xhr.open(this.method,this.url);for(var t in this.headers)this.xhr.setRequestHeader(t,this.headers[t]);this.xhr.withCredentials=this.withCredentials,this.xhr.send(this.payload)},this.close=function(){this.readyState!==this.CLOSED&&(this.xhr.abort(),this.xhr=null,this._setReadyState(this.CLOSED))}};f.SSE=r})(J);function M(f){let r,n;return{c(){r=b("p"),n=O(f[1])},l(s){r=S(s,"P",{});var t=x(r);n=I(t,f[1]),t.forEach(v)},m(s,t){R(s,r,t),d(r,n)},p(s,t){t&2&&U(n,s[1])},d(s){s&&v(r)}}}function V(f){let r,n,s,t,e,i,l,o,c,u,g,C,m,y,T,k,P,A,a=f[1]&&M(f);return{c(){r=b("h1"),n=O("flirtatiousBot"),s=L(),t=b("form"),e=b("label"),i=O("Introduce yourself to the bot:"),l=L(),o=b("textarea"),c=L(),u=b("button"),g=O("Introduce Yourself"),C=L(),m=b("div"),y=b("h2"),T=O("flirtatiousBot:"),k=L(),a&&a.c(),this.h()},l(h){r=S(h,"H1",{class:!0});var E=x(r);n=I(E,"flirtatiousBot"),E.forEach(v),s=w(h),t=S(h,"FORM",{});var _=x(t);e=S(_,"LABEL",{class:!0,for:!0});var D=x(e);i=I(D,"Introduce yourself to the bot:"),D.forEach(v),l=w(_),o=S(_,"TEXTAREA",{class:!0,name:!0,rows:!0}),x(o).forEach(v),c=w(_),u=S(_,"BUTTON",{class:!0});var G=x(u);g=I(G,"Introduce Yourself"),G.forEach(v),C=w(_),m=S(_,"DIV",{class:!0});var N=x(m);y=S(N,"H2",{class:!0});var H=x(y);T=I(H,"flirtatiousBot:"),H.forEach(v),k=w(N),a&&a.l(N),N.forEach(v),_.forEach(v),this.h()},h(){p(r,"class","text-4xl font-bold text-[#328eef]"),p(e,"class","text-[#fffb00] text-xl mb-1"),p(e,"for","context"),p(o,"class","bg-black border text-[#328eef]"),p(o,"name","context"),p(o,"rows","5"),p(u,"class","btn btn-black w-fit mx-auto mt-3 p-4 rounded-full border border-gray-900 text-[#7f7d76] shadow-md shadow-gray-700 hover:scale-110 ease-in duration-200 hover:text-[#fffb00] hover:border-[#328eef] hover:shadow-[#328eef] text-sm md:text-lg"),p(y,"class","text-2xl font-bold"),p(m,"class","pt-4")},m(h,E){R(h,r,E),d(r,n),R(h,s,E),R(h,t,E),d(t,e),d(e,i),d(t,l),d(t,o),B(o,f[0]),d(t,c),d(t,u),d(u,g),d(t,C),d(t,m),d(m,y),d(y,T),d(m,k),a&&a.m(m,null),P||(A=[F(o,"input",f[3]),F(t,"submit",j(f[4]))],P=!0)},p(h,[E]){E&1&&B(o,h[0]),h[1]?a?a.p(h,E):(a=M(h),a.c(),a.m(m,null)):a&&(a.d(1),a=null)},i:q,o:q,d(h){h&&v(r),h&&v(s),h&&v(t),a&&a.d(),P=!1,K(A)}}}function z(f,r,n){let s="",t=!1,e="";const i=async()=>{t=!0,n(1,e="");const c=new J.SSE("/api/explain",{headers:{"Content-Type":"application/json"},payload:JSON.stringify({context:s})});n(0,s=""),c.addEventListener("error",u=>{t=!1,alert("Something went wrong!")}),c.addEventListener("message",u=>{try{if(t=!1,u.data==="[DONE]")return;const g=JSON.parse(u.data),[{text:C}]=g.choices;n(1,e=(e??"")+C)}catch(g){t=!1,console.error(g),alert("Something went wrong!")}}),c.stream()};function l(){s=this.value,n(0,s)}return[s,e,i,l,()=>i()]}class W extends X{constructor(r){super(),Y(this,r,z,V,Z,{})}}export{W as default};
